;-------------------------------------------------
;设置モンスター在地宫中的位置
;ARG为0时从名单中选取
;ARG为想要派遣的モンスター编号
;-------------------------------------------------
@SET_SUCCUBUS, ARG
#DIM COUNT1
#DIM COUNT2
#DIM CHOICE
#DIM CHOICE2
#DIM SUCCUBUS_NO

IF ARG == 0
    CALL PRINT_SUCCUBUS_LIST,1
    SUCCUBUS_NO = RESULT
    IF RESULT == 999
        RETURN
    ENDIF
ELSE
    SUCCUBUS_NO = ARG
ENDIF

ALIGNMENT CENTER
CALL PRINT_DUNGEON ,1
ALIGNMENT LEFT

$INPUT_LOOP
INPUT

CHOICE = RESULT
SELECTCASE CHOICE
CASE 100

    RETURN

CASE 101
    CALL DEL_SUCCUBUS_FROM_DUNGEON, SUCCUBUS_NO
    RETURN

CASE 901 TO 999
	LOCAL = (CHOICE - 900)/10
	LOCAL:1 = CHOICE - 900 - LOCAL * 10

    CALL CALL_SUCCUBUS_NAME,SUCCUBUS_NO,0
    LOCALS = %TEXT_RETURN:0%を
    TRYCALLFORM ROOM_NAME_{DUNGEON:LOCAL:(LOCAL:1)}
    LOCALS = %LOCALS%%TEXT_RETURN:0%の
    CALL CALL_SUCCUBUS_NAME,SUCCUBUS_LOCATION:LOCAL:(LOCAL:1),0
    IF TEXT_RETURN:0 == ""
        TEXT_RETURN:0 = 誰いない
    ENDIF
    LOCALS = %LOCALS%%TEXT_RETURN:0%位置に配置するか。
    PRINTFORM %LOCALS%
    PRINTL
    CALL PRINT_BUTTON_17,"はい",100,1
    PRINTL
    CALL PRINT_BUTTON_17,"いいえ",101,1
    PRINTL

    $INPUT_LOOP_2
    INPUT
    CHOICE2 = RESULT

    SELECTCASE CHOICE2
        CASE 100
            IF SUCCUBUS_LOCATION:LOCAL:(LOCAL:1) > 0
                CALL DEL_SUCCUBUS_FROM_DUNGEON, SUCCUBUS_LOCATION:LOCAL:(LOCAL:1)
            ENDIF
            CALL DEL_SUCCUBUS_FROM_DUNGEON, SUCCUBUS_NO
            SUCCUBUS_LOCATION:LOCAL:(LOCAL:1) = SUCCUBUS_NO
            TRYCALLFORM ROOM_ACT_{DUNGEON:LOCAL:(LOCAL:1)}, SUCCUBUS_NO, 0, 0,DUNGEON_LEVEL:LOCAL:(LOCAL:1), LOCAL, LOCAL:1
        CASE 101
        
        CASEELSE
            GOTO INPUT_LOOP_2
    ENDSELECT

CASE 801 TO 899
	LOCAL = (CHOICE - 800)/10
	LOCAL:1 = CHOICE - 800 - LOCAL * 10
	CALL PRINT_ROOM, DUNGEON:LOCAL:(LOCAL:1),LOCAL,LOCAL:1

CASE 800
    CALL CALL_SUCCUBUS_NAME,SUCCUBUS_NO,0
    LOCALS = %TEXT_RETURN:0%を 
    LOCALS = %LOCALS%魔王宮殿の
    CALL CALL_SUCCUBUS_NAME,BOSSROOM_SUCCUBUS:1,0
    IF TEXT_RETURN:0 == ""
        TEXT_RETURN:0 = 誰もいない
    ENDIF
    LOCALS = %LOCALS%%TEXT_RETURN:0%位置に配置するか。
    PRINTFORM %LOCALS%
    PRINTL
    CALL PRINT_BUTTON_17,"はい",100,1
    PRINTL
    CALL PRINT_BUTTON_17,"いいえ",101,1
    PRINTL

    $INPUT_LOOP_3
    INPUT
    CHOICE2 = RESULT

    SELECTCASE CHOICE2
        CASE 100
            IF BOSSROOM_SUCCUBUS:1 > 0
                CALL DEL_SUCCUBUS_FROM_BOSSROOM, 1
            ENDIF
            CALL DEL_SUCCUBUS_FROM_DUNGEON, SUCCUBUS_NO
            BOSSROOM_SUCCUBUS:1 = SUCCUBUS_NO
        CASE 101
        
        CASEELSE
            GOTO INPUT_LOOP_3
    ENDSELECT

CASE 900

    CALL CALL_SUCCUBUS_NAME,SUCCUBUS_NO,0
    LOCALS = %TEXT_RETURN:0%を 
    LOCALS = %LOCALS%魔王宮殿の
    CALL CALL_SUCCUBUS_NAME,BOSSROOM_SUCCUBUS:2,0
    IF TEXT_RETURN:0 == ""
        TEXT_RETURN:0 = 誰もいない
    ENDIF
    LOCALS = %LOCALS%%TEXT_RETURN:0%位置に配置するか。
    PRINTFORM %LOCALS%
    PRINTL
    CALL PRINT_BUTTON_17,"はい",100,1
    PRINTL
    CALL PRINT_BUTTON_17,"いいえ",101,1
    PRINTL

    $INPUT_LOOP_4
    INPUT
    CHOICE2 = RESULT

    SELECTCASE CHOICE2
        CASE 100
            IF BOSSROOM_SUCCUBUS:2> 0
                CALL DEL_SUCCUBUS_FROM_BOSSROOM, 2
            ENDIF
            CALL DEL_SUCCUBUS_FROM_DUNGEON, SUCCUBUS_NO
            BOSSROOM_SUCCUBUS:2 = SUCCUBUS_NO
        CASE 101
        
        CASEELSE
            GOTO INPUT_LOOP_4
    ENDSELECT

CASE 700
    PRINTFORMW 魔王は変更できない
    CLEARLINE 1
    GOTO INPUT_LOOP

CASEELSE
    GOTO INPUT_LOOP
ENDSELECT




;----------------------------------------------------
;从地宫中撤去ARG的位置
@DEL_SUCCUBUS_FROM_DUNGEON,ARG
#DIM COUNT1
#DIM COUNT2
#DIM FOUND_FLAG

FOUND_FLAG = 0

SIF ARG <= 0
    RETURN

FOR COUNT1,0,3
	IF BOSSROOM_SUCCUBUS:COUNT1 == ARG
		BOSSROOM_SUCCUBUS:COUNT1 = -1
		RETURN
	ENDIF
NEXT

FOR COUNT1,DUNGEON_START_X,DUNGEON_END_X + 1
    FOR COUNT2,DUNGEON_START_Y,DUNGEON_END_Y + 1
        IF SUCCUBUS_LOCATION:COUNT1:COUNT2 == ARG
			TRYCALLFORM ROOM_ACT_{DUNGEON:COUNT1:COUNT2}, ARG, -1,0,DUNGEON_LEVEL:COUNT1:COUNT2, COUNT1, COUNT2
			SUCCUBUS_LOCATION:COUNT1:COUNT2 = -1
			RETURN
        ENDIF
    NEXT
NEXT

;----------------------------------------------------
;从魔王宫殿中撤去ARG号モンスター的位置
@DEL_SUCCUBUS_FROM_BOSSROOM,ARG
#DIM TARGET_SUCCUBUS
VARSET TEXT_RETURN

FOUND_FLAG = 0

SIF ARG <= 0
    RETURN
TARGET_SUCCUBUS = BOSSROOM_SUCCUBUS:ARG

TRYCALLFORM ROOM_ACT_1, TARGET_SUCCUBUS, -1,0,1,BOSS_LOCATION_X, BOSS_LOCATION_Y
BOSSROOM_SUCCUBUS:ARG = -1

;---------------------------------------------------
;寻找モンスター的位置，范围位置坐标x,y
@FIND_SUCCUBUS, ARG
#DIM COUNT1
#DIM COUNT2
#DIM FOUND_FLAG
FOUND_FLAG = 0

FOR COUNT1,0,3
	IF BOSSROOM_SUCCUBUS:COUNT1 == ARG
		RETURN BOSS_LOCATION_X, BOSS_LOCATION_Y
	ENDIF
NEXT

FOR COUNT1,DUNGEON_START_X,DUNGEON_END_X + 1
    FOR COUNT2,DUNGEON_START_Y,DUNGEON_END_Y + 1
        IF SUCCUBUS_LOCATION:COUNT1:COUNT2 == ARG
			RETURN COUNT1,COUNT2
        ENDIF
    NEXT
NEXT

RETURN -1,-1