;-------------------------------------------------
;战斗记录相关，可以用于DEBUG检查战斗的进行情况
;最大记录上限为300，由BATTLE_LOG_NUM记录最后一条空的记录的位置。开始位置为0
;使用RESET_BATTLE_LOG对战斗记录进行重置
;默认战斗过程中显示最后五条记录
;BATTLE_LOG_NUM会不断循环到最开始重新计数
;一般来说只有勇者进入房间，触发罠，被击败以及モンスター被击败会写入LOG
;-------------------------------------------------
;添加BATTLE_LOG
@ADD_BATTLE_LOG,ARGS
BATTLE_LOG:BATTLE_LOG_NUM = %ARGS%
CALL BATTLE_LOG_NUM_INCREASE

;管理BATTLE_LOG_NUM
@BATTLE_LOG_NUM_INCREASE
BATTLE_LOG_NUM = BATTLE_LOG_NUM + 1
IF BATTLE_LOG_NUM >= 300
    BATTLE_LOG_NUM = 0
ENDIF
RETURN BATTLE_LOG_NUM

;返回减少的BATTLE_LOG_NUM，但是实际上不影响真实数据
@BATTLE_LOG_NUM_DECREASE(ARG)
#FUNCTION
IF ARG - 1 < 0
    RETURNF 299
ENDIF
RETURNF ARG - 1

;打印BATTLE_LOG
@PRINTL_BATTLE_LOG,ARG
IF BATTLE_LOG:ARG == ""
    RETURN
ENDIF
CALL PRINT_STRL,@"%BATTLE_LOG:ARG%"

;显示固定数量的BATTLE_LOG
;ARG为显示的数目
@SHOW_BATTLE_LOG,ARG
#DIM COUNT1
#DIM COUNT2

COUNT2 = BATTLE_LOG_NUM
FOR COUNT1,0,ARG
    COUNT2 = BATTLE_LOG_NUM_DECREASE(COUNT2)    
    CALL PRINTL_BATTLE_LOG,COUNT2
NEXT